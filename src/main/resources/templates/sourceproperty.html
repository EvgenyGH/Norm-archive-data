<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
</head>

<body>
<div class="source-properties-list" th:fragment="all-source-properties(sourceProperties, reportYear)">
    <form class="select-year" th:action="@{/sourceproperty}" method="get">
        <label for="select-year">Год</label>
        <select id="select-year" name="selectedYear">
            <option th:each="year : ${#numbers.sequence(2020, #dates.createNow().getYear() + 1905, 1)}"
                    th:value="${year}" th:text="${year}" th:selected="${reportYear == year}"></option>
        </select>
        <input type="submit" value="Обновить">
    </form>
    <table>
        <th>Номер</th>
        <th>Источник</th>
        <th>Номер филиала</th>
        <th>Номер тарифной зоны</th>
        <th>Изменить</th>
        <th>Удалить</th>
        <tr th:each="property : ${sourceProperties}" th:object="${property}">
            <td hidden="hidden" th:text="*{sourceId}">Id источника</td>
            <td hidden="hidden" th:text="*{year}">Отчетный год</td>
            <td th:text="*{sourceName}">Источник (имя)</td>
            <td th:text="*{branch}">Номер филиала</td>
            <td th:text="*{tariffZoneName}">Номер тарифной зоны</td>
            <td>
                <form th:action="@{/sourceproperty/alter}" th:method="get">
                    <input type="hidden" name="SourceId" th:value="*{sourceId}">
                    <input type="hidden" name="year" th:value="*{year}">
                    <input type="submit" value="Изменить">
                </form>
            </td>
            <td>
                <form th:action="@{'/sourceproperty/' + *{id}}" th:method="delete">
                    <input hidden="hidden" name="year" th:object="*{year}">
                    <input type="submit" value="Удалить">
                </form>
            </td>
        </tr>
    </table>
</div>

<div class="alter-source-property" th:fragment="alter-source-property(sourceProperty)">
    <form th:action="@{/sourceproperty}" th:object="${sourceProperty}"
          th:with="newZone=${tariffZone.id == null}"
          th:method="${newZone ? 'post' : 'put'}">
        <fieldset>
            <legend th:text="${newZone ? 'Создать новую тарифную зону:' + newZone
                    : 'Изменить данные тарифной зоны:' + newZone}">
            </legend>
            <label th:for="${#ids.next('id')}">Номер:</label>
            <br>
            <input type="text" th:field="*{id}" placeholder="Номер зоны"
                   th:readonly="${!newZone}" th:value="tariffZone.id">
            <br>
            <label th:for="${#ids.next('zoneName')}">Название тарифной зоны:</label>
            <br>
            <input type="text" th:field="*{zoneName}" placeholder="Название тарифной зоны"
                   th:value="${tariffZone.zoneName}">
            <br>
            <input type="submit" value="Сохранить">
            <a th:href="@{/tariffzone}">Отмена</a>
        </fieldset>
    </form>
</div>
</body>
</html>